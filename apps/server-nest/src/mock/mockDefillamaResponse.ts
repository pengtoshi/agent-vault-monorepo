import { faker } from "@faker-js/faker";
import { NetworkNameByChainId } from "@libs/constants";
import type { DefillamaYieldType } from "@libs/model";
import { PredictedClassType } from "@libs/model";

// const sampleData = [
//   {
//     chain: "Ethereum",
//     project: "lido",
//     symbol: "STETH",
//     tvlUsd: 16743851462,
//     apyBase: 2.993,
//     apyReward: null,
//     apy: 2.993,
//     rewardTokens: null,
//     pool: "747c1d2a-c668-4682-b9f9-296708a3dd90",
//     apyPct1D: 0.232,
//     apyPct7D: 0.244,
//     apyPct30D: -0.622,
//     stablecoin: false,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Stable/Up",
//       predictedProbability: 71,
//       binnedConfidence: 2,
//     },
//     poolMeta: null,
//     mu: 3.86616,
//     sigma: 0.05214,
//     count: 1039,
//     outlier: false,
//     underlyingTokens: ["0x0000000000000000000000000000000000000000"],
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 2.92013,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Ethereum",
//     project: "ether.fi-stake",
//     symbol: "WEETH",
//     tvlUsd: 4062141214,
//     apyBase: 3.52157,
//     apyReward: 0.42154,
//     apy: 3.94311,
//     rewardTokens: ["0x8F08B70456eb22f6109F57b8fafE862ED28E6040"],
//     pool: "46bd2bdf-6d92-4066-b482-e885ee172264",
//     apyPct1D: 1.13877,
//     apyPct7D: 0.64805,
//     apyPct30D: 0.52296,
//     stablecoin: false,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Stable/Up",
//       predictedProbability: 54,
//       binnedConfidence: 1,
//     },
//     poolMeta: null,
//     mu: 3.22725,
//     sigma: 0.04338,
//     count: 304,
//     outlier: false,
//     underlyingTokens: ["0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"],
//     il7d: null,
//     apyBase7d: 2.98181,
//     apyMean30d: 3.42496,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Ethereum",
//     project: "binance-staked-eth",
//     symbol: "WBETH",
//     tvlUsd: 3347311086,
//     apyBase: 3.13754,
//     apyReward: null,
//     apy: 3.13754,
//     rewardTokens: null,
//     pool: "80b8bf92-b953-4c20-98ea-c9653ef2bb98",
//     apyPct1D: 0.17848,
//     apyPct7D: 0.52633,
//     apyPct30D: 0.06899,
//     stablecoin: false,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Stable/Up",
//       predictedProbability: 60,
//       binnedConfidence: 1,
//     },
//     poolMeta: null,
//     mu: 3.242,
//     sigma: 0.03101,
//     count: 657,
//     outlier: false,
//     underlyingTokens: ["0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"],
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 2.78725,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Ethereum",
//     project: "aave-v3",
//     symbol: "WBTC",
//     tvlUsd: 3069587421,
//     apyBase: 0.02506,
//     apyReward: null,
//     apy: 0.02506,
//     rewardTokens: null,
//     pool: "7e382157-b1bc-406d-b17b-facba43b716e",
//     apyPct1D: -0.00066,
//     apyPct7D: 0.00184,
//     apyPct30D: 0.00067,
//     stablecoin: false,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Stable/Up",
//       predictedProbability: 82,
//       binnedConfidence: 3,
//     },
//     poolMeta: null,
//     mu: 0.10398,
//     sigma: 0.00663,
//     count: 786,
//     outlier: false,
//     underlyingTokens: ["0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599"],
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 0.02493,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Ethereum",
//     project: "sky-lending",
//     symbol: "SUSDS",
//     tvlUsd: 3031067541,
//     apyBase: null,
//     apyReward: null,
//     apy: 4.5,
//     rewardTokens: null,
//     pool: "d8c4eff5-c8a9-46fc-a888-057c4c668e72",
//     apyPct1D: 0,
//     apyPct7D: 0,
//     apyPct30D: -2,
//     stablecoin: true,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Stable/Up",
//       predictedProbability: 62,
//       binnedConfidence: 2,
//     },
//     poolMeta: null,
//     mu: 6.09268,
//     sigma: 0.05708,
//     count: 43,
//     outlier: false,
//     underlyingTokens: ["0xdC035D45d973E3EC169d2276DDab16f1e407384F"],
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 5.78889,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Ethereum",
//     project: "aave-v3",
//     symbol: "WEETH",
//     tvlUsd: 2819173162,
//     apyBase: 0.00065,
//     apyReward: null,
//     apy: 0.00065,
//     rewardTokens: null,
//     pool: "db678df9-3281-4bc2-a8bb-01160ffd6d48",
//     apyPct1D: 0,
//     apyPct7D: -0.00011,
//     apyPct30D: -0.00029,
//     stablecoin: false,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Stable/Up",
//       predictedProbability: 83,
//       binnedConfidence: 3,
//     },
//     poolMeta: null,
//     mu: 0.09879,
//     sigma: 0.00883,
//     count: 356,
//     outlier: false,
//     underlyingTokens: ["0xCd5fE23C85820F7B72D0926FC9b05b43E359b7ee"],
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 0.00082,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Ethereum",
//     project: "rocket-pool",
//     symbol: "RETH",
//     tvlUsd: 2350993119,
//     apyBase: 2.46193,
//     apyReward: null,
//     apy: 2.46193,
//     rewardTokens: null,
//     pool: "d4b3c522-6127-4b89-bedf-83641cdcd2eb",
//     apyPct1D: 0.00284,
//     apyPct7D: -0.55224,
//     apyPct30D: -0.04825,
//     stablecoin: false,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Stable/Up",
//       predictedProbability: 66,
//       binnedConfidence: 2,
//     },
//     poolMeta: null,
//     mu: 3.24454,
//     sigma: 0.0381,
//     count: 807,
//     outlier: false,
//     underlyingTokens: ["0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"],
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 2.95506,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Ethereum",
//     project: "aave-v3",
//     symbol: "WSTETH",
//     tvlUsd: 2069819763,
//     apyBase: 0.11768,
//     apyReward: null,
//     apy: 0.11768,
//     rewardTokens: null,
//     pool: "e6435aae-cbe9-4d26-ab2c-a4d533db9972",
//     apyPct1D: 0.00201,
//     apyPct7D: 0.00477,
//     apyPct30D: 0.00038,
//     stablecoin: false,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Down",
//       predictedProbability: 52,
//       binnedConfidence: 1,
//     },
//     poolMeta: null,
//     mu: 0.02776,
//     sigma: 0.00269,
//     count: 786,
//     outlier: false,
//     underlyingTokens: ["0x7f39C581F595B53c5cb19bD0b3f8dA6c935E2Ca0"],
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 0.10886,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Ethereum",
//     project: "ethena-usde",
//     symbol: "SUSDE",
//     tvlUsd: 1959008680,
//     apyBase: 4.5062,
//     apyReward: null,
//     apy: 4.5062,
//     rewardTokens: null,
//     pool: "66985a81-9c51-46ca-9977-42b4fe7bc6df",
//     apyPct1D: -6.20631,
//     apyPct7D: -5.60173,
//     apyPct30D: -6.18251,
//     stablecoin: true,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Stable/Up",
//       predictedProbability: 87,
//       binnedConfidence: 3,
//     },
//     poolMeta: "7 days unstaking",
//     mu: 14.6573,
//     sigma: 0.4224,
//     count: 412,
//     outlier: false,
//     underlyingTokens: null,
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 6.5249,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Solana",
//     project: "jito",
//     symbol: "JITOSOL",
//     tvlUsd: 1939794646,
//     apyBase: 8.85,
//     apyReward: null,
//     apy: 8.85,
//     rewardTokens: null,
//     pool: "0e7d0722-9054-4907-8593-567b353c0900",
//     apyPct1D: 1.13,
//     apyPct7D: 0.79,
//     apyPct30D: null,
//     stablecoin: false,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: "Stable/Up",
//       predictedProbability: 78,
//       binnedConfidence: 3,
//     },
//     poolMeta: null,
//     mu: 8.09609,
//     sigma: 0.02262,
//     count: 10,
//     outlier: false,
//     underlyingTokens: ["J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn"],
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 7.95768,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
//   {
//     chain: "Ethereum",
//     project: "spark",
//     symbol: "WSTETH",
//     tvlUsd: 1680067898,
//     apyBase: 0,
//     apyReward: null,
//     apy: 0,
//     rewardTokens: null,
//     pool: "3b45941c-16cb-48c5-a490-16c6c4f1d86a",
//     apyPct1D: 0,
//     apyPct7D: 0,
//     apyPct30D: 0,
//     stablecoin: false,
//     ilRisk: "no",
//     exposure: "single",
//     predictions: {
//       predictedClass: null,
//       predictedProbability: null,
//       binnedConfidence: null,
//     },
//     poolMeta: null,
//     mu: 0.00207,
//     sigma: 0.00035,
//     count: 693,
//     outlier: false,
//     underlyingTokens: ["0x7f39C581F595B53c5cb19bD0b3f8dA6c935E2Ca0"],
//     il7d: null,
//     apyBase7d: null,
//     apyMean30d: 0,
//     volumeUsd1d: null,
//     volumeUsd7d: null,
//     apyBaseInception: null,
//   },
// ];

export const mockDefillamaResponse = (chainId: string, projectName: string): DefillamaYieldType => {
  // TVL: $1M ~ $5B range
  const tvl = faker.datatype.float({
    min: 1_000_000,
    max: 5_000_000_000,
    precision: 0.01,
  });

  // Base APY: 0 ~ 10%
  const apyBase = faker.datatype.float({
    min: 0,
    max: 10,
    precision: 0.001,
  });

  // Reward APY: 0 ~ 5%
  const apyReward = faker.datatype.float({
    min: 0,
    max: 5,
    precision: 0.001,
  });

  // Total APY = Base + Reward
  const apy = apyBase + apyReward;

  // APY change rate: -10% ~ 10%
  const apyPct1D = faker.datatype.float({ min: -10, max: 10, precision: 0.001 });
  const apyPct7D = faker.datatype.float({ min: -10, max: 10, precision: 0.001 });
  const apyPct30D = faker.datatype.float({ min: -10, max: 10, precision: 0.001 });

  // IL Risk: mainly 'no' or 'yes'
  const ilRisk = faker.helpers.arrayElement(["no", "yes"]);

  // Predictions
  const predictions = {
    predictedClass: faker.helpers.arrayElement(Object.values(PredictedClassType)),
    predictedProbability: faker.datatype.number({ min: 50, max: 90 }), // Prediction probability
    binnedConfidence: faker.datatype.number({ min: 1, max: 3 }), // Confidence level
  };

  // Historical APY data
  const apyBase7d = faker.datatype.float({
    min: Math.max(0, apyBase - 1),
    max: apyBase + 1,
    precision: 0.001,
  });

  const apyMean30d = faker.datatype.float({
    min: Math.max(0, apyBase - 1),
    max: apyBase + 1,
    precision: 0.001,
  });

  // Volume: 0 ~ 10% of TVL
  const maxVolume = tvl * 0.1;
  const volumeUsd1d = faker.datatype.float({
    min: 0,
    max: maxVolume,
    precision: 0.01,
  });
  const volumeUsd7d =
    volumeUsd1d *
    faker.datatype.float({
      min: 5,
      max: 7,
      precision: 0.1,
    });

  return {
    chain: NetworkNameByChainId[chainId],
    project: projectName,
    tvlUsd: tvl,
    apyBase,
    apyReward,
    apy,
    apyPct1D,
    apyPct7D,
    apyPct30D,
    ilRisk,
    predictions,
    apyBase7d,
    apyMean30d,
    volumeUsd1d,
    volumeUsd7d,
  };
};
